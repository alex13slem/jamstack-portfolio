---
import type { GetStaticPaths } from "astro";
import SeoFragment from "@/common/components/SeoFragment.astro";
import Layout from "@/common/templates/Layout.astro";
import { getProjectsWithTechnologies } from "@/lib/cruds/project";
import DetailPage from "@/features/product/templates/DetailPage.astro";

export const getStaticPaths = (async () => {
  const projects = await getProjectsWithTechnologies("en");
  return projects.map((project) => ({
    params: {
      id: project.id,
    },
    props: { project },
  }));
}) satisfies GetStaticPaths;

const { project } = Astro.props;
---

<Layout>
  <SeoFragment
    slot="head"
    title={project.name}
    description={project.description}
    imageUrls={{ fb: project.image_cover }}
  />

  <DetailPage {project} />
</Layout>

<script>
  import { suggestRussianVersion } from "@/i18n/utils";

  document.addEventListener("DOMContentLoaded", suggestRussianVersion);
  document.addEventListener("visibilitychange", suggestRussianVersion);
</script>
